<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="manifest" href="/static/manifest.json">
    <link rel="stylesheet" href="/static/css/style.css">
    <title>Quản lý xác nhận - truy xuất QR thiết bị</title>
</head>

<body>

    <div class="container">
        <div class="header">
            <h1>Quản lý xác nhận - truy xuất QR thiết bị</h1>
            <div id="connection-status" class="status-badge">Online</div>
            <div id="user-info" style="font-size: 0.9rem; margin-top: 5px; color: #555; display: none;"></div>
            <button id="logout-btn" class="btn btn-secondary"
                style="font-size: 0.8rem; padding: 5px 10px; margin-top: 5px; display: none;">Đăng xuất</button>
        </div>

        <!-- Step 0: Login -->
        <div id="login-section" class="card">
            <h2>Đăng nhập Nhân viên</h2>
            <div class="input-group">
                <label for="employee-code">Mã Nhân viên</label>
                <input type="text" id="employee-code" class="input-control" placeholder="Nhập mã nhân viên">
            </div>
            <div class="input-group">
                <label for="employee-password">Mật khẩu</label>
                <input type="password" id="employee-password" class="input-control"
                    placeholder="Mật khẩu (Mặc định: 1234)">
            </div>
            <button id="login-btn" class="btn btn-primary">Đăng nhập</button>
        </div>

        <!-- Step 0.5: Change Password -->
        <div id="change-password-section" class="card hidden">
            <h2>Đổi Mật khẩu (Bắt buộc)</h2>
            <p>Đây là lần đăng nhập đầu tiên. Vui lòng đổi mật khẩu.</p>
            <div class="input-group">
                <label for="new-password">Mật khẩu mới</label>
                <input type="password" id="new-password" class="input-control" placeholder="Nhập mật khẩu mới">
            </div>
            <div class="input-group">
                <label for="confirm-password">Xác nhận mật khẩu</label>
                <input type="password" id="confirm-password" class="input-control" placeholder="Nhập lại mật khẩu mới">
            </div>
            <button id="change-pass-btn" class="btn btn-primary">Đổi Mật khẩu & Tiếp tục</button>
        </div>

        <!-- Step 1: Scan Label -->
        <div id="scan-section" class="card hidden">
            <h2>Quét QR thiết bị</h2>
            <p>Canh chỉnh mã QR trong khung.</p>
            <div id="reader"></div>
            <div style="font-size: 0.8rem; color: #666; text-align: center; margin-top: 10px;">
                Hỗ trợ QR & Barcodes
            </div>
        </div>

        <!-- Step 2: Camera / OCR (REMOVED/HIDDEN as per req "Bỏ verify serial") -->
        <!-- We keep it hidden just in case but flow will skip it -->
        <div id="camera-section" class="card hidden">
            <h2>Xác nhận số Serial</h2>
            <!-- Content removed for simplicity, flow skips this -->
        </div>

        <!-- Step 3: Manual Confirmation (REMOVED/HIDDEN) -->
        <div id="manual-section" class="card hidden">
            <!-- Content removed for simplicity, flow skips this -->
        </div>

        <!-- Step 4: Result -->
        <div id="result-section" class="card hidden">
            <h2>Kết quả Xác nhận</h2>
            <div id="result-message" class="result-scan">--</div>
            <div id="result-details" style="text-align: center; margin: 1rem 0;"></div>
            <div id="result-link-container" style="text-align: center; margin-bottom: 1rem;"></div>
            <button id="reset-btn" class="btn btn-secondary">Tiếp tục quét</button>
        </div>

    </div>

    <!-- Navigation -->
    <nav class="nav">
        <a href="/" class="nav-item active">
            <span>Quét QR thiết bị</span>
        </a>
        <a href="/logs" class="nav-item">
            <span>Lịch sử quét</span>
        </a>
        <a href="/admin" class="nav-item">
            <span>Quản trị</span>
        </a>
    </nav>

    <!-- Scripts -->
    <script src="/static/vendor/html5-qrcode.min.js"></script>
    <script src="/static/vendor/tesseract.min.js"></script>
    <script type="module" src="/static/js/app.js"></script>

</body>

</html>